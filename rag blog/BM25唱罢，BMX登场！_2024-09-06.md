è®ºæ–‡ç¬”è®°åˆ†äº«ï¼Œè®ºæ–‡æ ‡é¢˜ï¼ŒBMX: Entropy-weighted Similarity and Semantic-enhanced Lexical Searchã€‚ ä»£ç ä»“åº“ï¼šhttps://github.com/mixedbread-ai/baguetter

å¤§å¤šæ•°æ–‡æœ¬æœç´¢å¼•æ“èƒŒåçš„ç®—æ³•å¤šå¤šå°‘å°‘éƒ½è·ŸBM25æ²¾è¾¹ï¼ŒBM25çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºï¼Œå®ƒåœ¨åˆ†å¸ƒä¹‹å¤–çš„æ•°æ®ä¸­è¡¨ç°å¾—éå¸¸å¥½ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥å¾ˆå¥½çš„å¤„ç†ä»¥å‰ä»æœªè§è¿‡çš„æ•°æ®ã€‚ä½†æ˜¯ï¼å…³é”®å­—æœç´¢æ–¹æ³•æœ‰å…¶è‡ªèº«çš„å±€é™æ€§ï¼š
- BM25 ä¸è€ƒè™‘æŸ¥è¯¢ä¸ä»»ä½•ç»™å®šæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œè¿™å¯ä»¥æ›´å‡†ç¡®åœ°è¯„ä¼°è¯¥æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§ã€‚
- è¯æ±‡æœç´¢ç®—æ³•ç¼ºä¹è¯­ä¹‰ç†è§£ï¼Œå› æ­¤æ— æ³•å¤„ç†åŒä¹‰è¯å’ŒåŒéŸ³å¼‚ä¹‰è¯ç­‰è¯­è¨€ç»†å¾®å·®åˆ«ã€‚ä¸åŸºäºç‰¹å®šé¢†åŸŸæ–‡æœ¬åµŒå…¥çš„è¯­ä¹‰æœç´¢ç›¸æ¯”ï¼Œè¿™ç§é™åˆ¶æ˜¯è¯æ³•æœç´¢æ€§èƒ½ä¸ä½³çš„å…³é”®å› ç´ ã€‚


äºæ˜¯æœ¬æ–‡æå‡ºäº†BMXï¼Œè®¡ç®—ç®€å•ï¼Œæ•ˆæœä¼˜äºæ‰€æœ‰çš„BM25å˜ç§,å»ºç´¢å¼•ï¼Œæœç´¢éƒ½ä¸ä¼šæ˜æ˜¾æ…¢ï¼Œä½†æ˜¯æ•ˆæœæ˜æ˜¾å¥½ï¼

![](https://files.mdnice.com/user/50285/e13f0d6e-3269-4faf-b3d6-512c9505d3ba.png)

```python
# pip install baguetter

from baguetter.indices import BMXSparseIndex
 
# Initialize BMğ’³ index
bmx = BMXSparseIndex()
 
# Add bakery items to the index
docs = [
    "Freshly crusty baked sourdough bread with a crispy crust",
    "Flaky croissants made with French butter",
    "Chocolate chip cookies with chunks of dark chocolate",
    "Cinnamon rolls with cream cheese frosting",
    "Artisanal baguettes with a soft interior and crusty exterior"
]
keys = list(range(len(docs)))
 
bmx.add_many(keys=keys, values=docs)
 
# Search for bread
query = "crusty bread"
results = bmx.search(query, top_k=2)
 
print(results)
# SearchResults(keys=[0, 4], scores=array([2.5519667 , 0.97304875], dtype=float32), normalized=False)
```


æ¥ä¸‹æ¥çœ‹çœ‹è®¡ç®—åŸç†å’Œæ•ˆæœ

å…ˆå¾—çœ‹çœ‹tfidfï¼Œè¯é¢‘\*é€†æ–‡æ¡£ç‡

![](https://files.mdnice.com/user/50285/f893cf46-4227-4c67-b404-727e4123efd1.png)

![](https://files.mdnice.com/user/50285/bea3c8b3-60e7-4274-961f-6589c9750392.png)

![](https://files.mdnice.com/user/50285/d2ef86ab-9bca-4c8f-8e98-8996e7557ed5.png)


tfidfå¾ˆå¥½äº†ï¼Œä½†æ˜¯è¯é¢‘score F(qi,D)æ˜¯ä¸€ä¸ªçº¿æ€§çš„åˆ†æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªtokenå‡ºç°é¢‘ç‡æ¯”å¦ä¸€ä¸ªå¤š 5 å€ï¼Œåˆ™å…¶ TF å€¼å°†æ¯”å¦ä¸€ä¸ªå¤§ 5 å€ï¼Œç„¶åBM25å°±å¯¹è¿™é‡Œåšäº†ä¼˜åŒ–

![](https://files.mdnice.com/user/50285/75286f3b-5329-4790-9c37-3eb532a1778c.png)


BMX åœ¨ BM25 ä¹‹ä¸Šï¼Œåˆ©ç”¨ç†µåŠ æƒç›¸ä¼¼åº¦å¯¹å…¶è¿›è¡Œå¢å¼ºï¼Œä»¥å®ç°æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´æ›´ç²¾ç¡®çš„ç›¸å…³æ€§è¯„ä¼°ï¼Œå¯ä»¥ç®€å•è¡¨è¾¾ä¸ºï¼š

![](https://files.mdnice.com/user/50285/94c78761-457a-43c3-af5b-4596a594a761.png)

![](https://files.mdnice.com/user/50285/44cdeb72-fe56-4fd6-ab59-eef1d16e4e05.png)

![](https://files.mdnice.com/user/50285/91b70026-f6fd-4cfa-a655-4031570e9ee0.png)

![](https://files.mdnice.com/user/50285/a0a48369-cb72-453c-8df1-66b6ef2f39d6.png)


ä¸åŸºäºåµŒå…¥çš„æ–¹æ³•ç›¸æ¯”ï¼ŒåŒ…æ‹¬ BM25 å’Œ BMX åœ¨å†…çš„è¯æ³•æœç´¢ç®—æ³•çš„ä¸€å¤§ç¼ºç‚¹æ˜¯ç¼ºä¹å¯¹æŸ¥è¯¢çš„è¯­ä¹‰ç†è§£ï¼Œå› ä¸ºå®ƒä»¬ä»…åŸºäºæŸ¥è¯¢æ ‡è®°æ¥æ£€ç´¢æ–‡æ¡£ï¼Œè€Œå¿½ç•¥äº†åŒä¹‰è¯å’ŒåŒéŸ³å¼‚ä¹‰è¯ç­‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé™åˆ¶ï¼Œå¯ä»¥é€šè¿‡æ‰‹åŠ¨åˆ¶ä½œåŒä¹‰è¯å’ŒåŒéŸ³å¼‚ä¹‰è¯çš„é›†åˆæ¥å®ŒæˆæŸ¥è¯¢å¢å¼ºã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨LLMæ¥å¢å¼ºæŸ¥è¯¢ã€‚

![](https://files.mdnice.com/user/50285/a9465784-f3bf-4afa-be69-04ba95361b5a.png)
è¿™ç§åŠ æƒæŸ¥è¯¢å¢å¼º (WQA) æ¨¡å¼å¯ä»¥ç»“åˆå¯¹æŸ¥è¯¢çš„è¯­ä¹‰ç†è§£LLMè¯æ³•æœç´¢ç®—æ³•ï¼ŒåŒæ—¶ä»ç„¶ä¿æŒå…¶è®¡ç®—æ•ˆç‡ã€‚

**æœ€åæ€§èƒ½æµ‹è¯•**ï¼š
![](https://files.mdnice.com/user/50285/de01b2f4-2e75-42f6-bddb-9af9065e5493.png)


